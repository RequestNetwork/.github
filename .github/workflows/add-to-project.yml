name: Add to Project

on:
  workflow_call:
    secrets:
      PROJECT_TOKEN:
        required: true

jobs:
  add-to-project:
    runs-on: ubuntu-latest
    # Only run for issues, skip PRs entirely
    if: github.event_name == 'issues'
    steps:
      - name: Add issue to project
        env:
          GH_TOKEN: ${{ secrets.PROJECT_TOKEN }}
        run: |
          PROJECT_ID="PVT_kwDOAdsAFs4AIPmg"

          gh api graphql -f query='
            mutation($projectId: ID!, $contentId: ID!) {
              addProjectV2ItemById(input: {
                projectId: $projectId
                contentId: $contentId
              }) {
                item { id }
              }
            }' -f projectId="$PROJECT_ID" \
               -f contentId="${{ github.event.issue.node_id }}"

          echo "Added issue to project"
